import{_ as Z}from"./AppLayout-C96qJ3dW.js";import{i as A,Q as J,q as X,J as L,a as E,b as N,w as m,u as i,F as $,r as B,o as x,d as S,t as I,Z as ee,D as te,h as H,E as ne,g as V,G as re,H as ae,e as R}from"./app-CPWJTjjn.js";import"./AppBreadcrumb-DxK5GBk6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";var oe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),a,s=[],u;try{for(;(t===void 0||t-- >0)&&!(a=r.next()).done;)s.push(a.value)}catch(p){u={error:p}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(u)throw u.error}}return s},le={N:"null",i:"int",d:"float",b:"boolean",s:"string",a:"array-object",C:"serializable-class",O:"notserializable-class"},ie=function(){function e(t,n,r){this.contents=t,this.index=n,this.options=r}return e.prototype.error=function(t){return t===void 0&&(t="Syntax Error"),new Error(t+" at index "+this.index+" while unserializing payload")},e.prototype.advance=function(t){this.index+=t},e.prototype.readAhead=function(t){var n=this.peekAhead(t);return this.index+=t,n},e.prototype.readUntil=function(t){var n=this.contents.indexOf(t,this.index);if(n===-1)throw this.error("Expected '"+t+"'");return this.readAhead(n-this.index)},e.prototype.peekAhead=function(t){return this.contents.toString(this.options.encoding,this.index,this.index+t)},e.prototype.seekExpected=function(t){var n=this.readAhead(t.length);if(n!==t)throw this.index-=t.length,this.error("Expected '"+t+"'")},e.prototype.getType=function(){var t=oe(this.readAhead(2),2),n=t[0],r=t[1],a=le[n];if(!a)throw this.error("Unknown type");if(a==="null"?r!==";":r!==":")throw this.error();return a},e.prototype.getLength=function(){var t=Number.parseInt(this.readUntil(":"),10);if(Number.isNaN(t))throw this.error();return t},e.prototype.getByLength=function(t,n,r){var a=this.getLength();this.seekExpected(":"+t);var s=r(a);return this.seekExpected(n),s},e}(),q=function(){function e(t){this.__PHP_Incomplete_Class_Name=t}return e}();function se(e){return typeof e=="number"&&Number.parseInt(e.toString(),10)===e}function ue(e){return new q(e)}function de(e){function t(){}return t.prototype=e,t}function K(e,t){if(!e)throw new Error(t)}var j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},j.apply(this,arguments)};function W(e,t,n){var r,a=t[e];return K(a||!n,"Class "+e+" not found in given scope"),a?r=new(de(a.prototype)):r=ue(e),r}function G(e,t,n,r){for(var a=[],s=0;s<t;s+=1){var u=M(e,n,r);e.seekExpected(";");var p=M(e,n,r);e.peekAhead(1)===";"&&e.advance(1),a.push({key:u,value:p})}return a}function M(e,t,n){var r=e.getType();if(r==="null")return null;if(r==="int"||r==="float"){var a=e.readUntil(";");return r==="int"?parseInt(a,10):parseFloat(a)}if(r==="boolean"){var a=e.readAhead(1);return a==="1"}if(r==="string")return e.getByLength('"','"',function(c){return e.readAhead(c)});if(r==="array-object"){var s=e.getByLength("{","}",function(c){return G(e,c,t,n)}),u=s.every(function(c,d){return se(c.key)&&d===c.key}),p=u?[]:{};return s.forEach(function(c){var d=c.key,h=c.value;p[d]=h}),p}if(r==="notserializable-class"){var _=e.getByLength('"','"',function(d){return e.readAhead(d)});e.seekExpected(":");var s=e.getByLength("{","}",function(d){return G(e,d,t,n)}),v=W(_,t,n.strict),C="\0"+_+"\0",O="\0*\0";return s.forEach(function(d){var h=d.key,k=d.value;h.startsWith(C)?v[h.slice(C.length)]=k:h.startsWith(O)?v[h.slice(O.length)]=k:v[h]=k}),v}if(r==="serializable-class"){var _=e.getByLength('"','"',function(d){return e.readAhead(d)});e.seekExpected(":");var g=e.getByLength("{","}",function(d){return e.readAhead(d)}),w=W(_,t,n.strict);return w instanceof q||(K(w.unserialize,"unserialize not found on class when processing '"+_+"'"),w.unserialize(g)),w}throw new Error("Invalid type '"+r+"' encounterd while unserializing")}function ce(e,t,n){t===void 0&&(t={}),n===void 0&&(n={});var r=j({},n);typeof r.strict>"u"&&(r.strict=!0),typeof r.encoding>"u"&&(r.encoding="utf8");var a=new ie(Buffer.from(e),0,r);return M(a,t,r)}function fe(){const e=A(),t=A([]),n=A(0),r=A(!0),a=A(0),s=[5,10,20,50],u=A(s[1]),{props:p}=J(),_=p.menu,v=[{field:"ip_address",header:"IP Address",bodyStyle:"text-align: center;",style:"width: 15%;"},{field:"name",header:"Name",bodyStyle:"text-align: left;",style:"width: 15%;"},{field:"email",header:"Email",bodyStyle:"text-align: left;",style:"width: 15%;"},{field:"payload",header:"Payload",bodyStyle:"text-align: left;",style:"width: 35%;"},{field:"last_activity",header:"Last Activity",bodyStyle:"text-align: center;",style:"width: 15%;"},{field:"actions",header:"Action",bodyStyle:"text-align: center;",style:"width: 5%;"}],C=o=>{try{const b=atob(o),y=ce(b);return JSON.stringify(y,null,2)}catch(b){return console.error("Error decoding or unserializing payload:",b),"Invalid data"}},O=o=>C(o),g=async({page:o,rows:b,sortField:y,sortOrder:z,filters:U})=>{try{r.value=!0;const F=await axios.get("session/get-datatable",{params:{page:o+1,rows:b,sortField:y,sortOrder:z===1?"asc":"desc",filters:U}});t.value=F.data.sessions,a.value=F.data.total,r.value=!1}catch(F){r.value=!1,console.error("Error fetching session data:",F)}},w=()=>{e.value={ip_address:{value:null,matchMode:L.CONTAINS},name:{value:null,matchMode:L.CONTAINS},email:{value:null,matchMode:L.CONTAINS},last_activity:{value:null,matchMode:L.BETWEEN}}},c=o=>new Date(o.replace(" ","T")).toLocaleDateString("id",{day:"numeric",month:"long",year:"numeric"}),d=()=>{w(),g({page:n.value,rows:u.value,sortField:null,sortOrder:null,filters:e.value})};function h(o){n.value=o.page,u.value=o.rows,g({page:n.value,rows:u.value,sortField:o.sortField,sortOrder:o.sortOrder,filters:o.filters})}const k=o=>{n.value=0,u.value=o.rows,g({page:n.value,rows:u.value,sortField:o.sortField,sortOrder:o.sortOrder,filters:e.value})};function D(o,b){e.value[o]?e.value[o].value=b:console.error(`Filter "${o}" tidak ditemukan.`),g({page:n.value,rows:u.value,sortField:null,sortOrder:null,filters:e.value})}function T(o){e.value[o]?e.value[o].value=null:console.error(`Filter "${o}" tidak ditemukan.`),g({page:n.value,rows:u.value,sortField:null,sortOrder:null,filters:e.value})}return{columns:v,sessions:t,totalRecords:a,filters:e,page:n,rows:u,rowOptions:s,loading:r,loadData:g,initFilters:w,clearFilters:d,onPageChange:h,onSort:k,onFilterApply:D,onFilterClear:T,onMounted:X,formatDate:c,getDecodedPayload:O,menu:_}}const ye={class:"col-12"},he={class:"card"},pe={class:"flex justify-content-between flex-column sm:flex-row"},ve={key:0},ge={key:1},me=["href"],_e=S("i",{class:"pi pi-eye",style:{color:"blue"}},null,-1),we=[_e],be={key:2},xe={key:3},Pe={__name:"Index",setup(e){const{props:t}=J(),n=t.menu,{filters:r,sessions:a,page:s,loading:u,totalRecords:p,rowOptions:_,rows:v,loadData:C,initFilters:O,formatDate:g,columns:w,onMounted:c,clearFilters:d,onPageChange:h,onSort:k,onFilterApply:D,onFilterClear:T,getDecodedPayload:o}=fe();return c(()=>{O(),C({page:s.value,rows:v.value,sortField:null,sortOrder:null,filters:r.value})}),(b,y)=>{const z=B("Button"),U=B("InputText"),F=B("Calendar"),Q=B("Column"),Y=B("DataTable");return x(),E($,null,[N(i(ee),null,{default:m(()=>[S("title",null,I(i(n)),1)]),_:1}),N(Z,null,{default:m(()=>[S("div",ye,[S("div",he,[S("h5",null,I("User "+i(n)),1),N(Y,{value:i(a),paginator:!0,rows:i(v),lazy:!0,rowsPerPageOptions:i(_),first:i(s)*i(v),dataKey:"id",rowHover:!0,filters:i(r),"onUpdate:filters":y[1]||(y[1]=l=>te(r)?r.value=l:null),loading:i(u),filterDisplay:"menu",showGridlines:"","removable-sort":!0,"null-sort-order":-1,"total-records":i(p),onSort:y[2]||(y[2]=l=>i(k)(l)),onPage:y[3]||(y[3]=l=>i(h)(l))},{header:m(()=>[S("div",pe,[N(z,{type:"button",icon:"pi pi-filter-slash",label:"Clear",outlined:"",onClick:y[0]||(y[0]=l=>i(d)())})])]),empty:m(()=>[H(" Session Not Found.")]),loading:m(()=>[H(" Loading customers data. Please wait.")]),default:m(()=>[(x(!0),E($,null,ne(i(w),l=>(x(),V(Q,{key:l.field,field:l.field,header:l.header,sortable:l.field!=="actions",filter:!0,"body-style":l.bodyStyle,showFilterMatchModes:!1,style:re(l.style)},ae({body:m(({data:f})=>[l.field==="last_activity"?(x(),E("span",ve,I(i(g)(f[l.field])),1)):l.field==="actions"?(x(),E("span",ge,[S("a",{href:f.actions.show,class:"p-button p-button-link"},we,8,me)])):l.field==="payload"?(x(),E("span",be,I(i(o)(f[l.field])),1)):(x(),E("span",xe,I(f[l.field]),1))]),filterapply:m(({filterModel:f,field:P})=>[N(z,{label:"Apply",class:"p-button-outlined p-button-sm",onClick:ke=>i(D)(P,f.value)},null,8,["onClick"])]),filterclear:m(({field:f})=>[N(z,{label:"Clear",type:"button",class:"p-button-outlined p-button-sm",onClick:P=>i(T)(f)},null,8,["onClick"])]),_:2},[l.field!=="payload"?{name:"filter",fn:m(({filterModel:f})=>[l.field==="name"||l.field==="email"?(x(),V(U,{key:0,type:"text",modelValue:f.value,"onUpdate:modelValue":P=>f.value=P,class:"p-column-filter",placeholder:"Search "+l.header},null,8,["modelValue","onUpdate:modelValue","placeholder"])):R("",!0),l.field==="last_activity"?(x(),V(F,{key:1,placeholder:"mm/dd/yyyy","selection-mode":"single",modelValue:f.value,"onUpdate:modelValue":P=>f.value=P},null,8,["modelValue","onUpdate:modelValue"])):R("",!0)]),key:"0"}:void 0]),1032,["field","header","sortable","body-style","style"]))),128))]),_:1},8,["value","rows","rowsPerPageOptions","first","filters","loading","total-records"])])])]),_:1})],64)}}};export{Pe as default};
