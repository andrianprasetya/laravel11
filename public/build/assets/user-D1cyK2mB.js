import{i,Q as A,I as E,B as L,q as $,J as f}from"./app-CEiRPCSS.js";function T(){const a=i(),v=i([]),l=i(0),u=i(!0),y=i(0),g=[5,10,20,50],r=i(g[1]),{props:w}=A(),F=E(),p=L(),D=w.menu+" List",O=[{field:"name",header:"Name",bodyStyle:"text-align: left;",style:"width: 25%;"},{field:"email",header:"Email",bodyStyle:"text-align: left;",style:"width: 25%;"},{field:"email_verified_at",header:"Verify",bodyStyle:"text-align: center;",style:"width: 10%;"},{field:"created_at",header:"Register Date",bodyStyle:"text-align: center;",style:"width: 20%;"},{field:"actions",header:"Action",bodyStyle:"text-align: center;",style:"width: 20%;"}],o=async({page:e,rows:s,sortField:n,sortOrder:d,filters:m})=>{try{u.value=!0;const t=await axios.get("user/get-datatable",{params:{page:e+1,rows:s,sortField:n,sortOrder:d===1?"asc":"desc",filters:m}});v.value=t.data.users.map(c=>({...c,created_at:new Date(c.created_at)})),console.log(v.value),y.value=t.data.total,u.value=!1}catch(t){u.value=!1,console.error("Error fetching data:",t)}finally{u.value=!1}},S=e=>e.toLocaleDateString("id",{day:"numeric",month:"long",year:"numeric"}),h=()=>{a.value={name:{value:null,matchMode:f.CONTAINS},email:{value:null,matchMode:f.CONTAINS},email_verified_at:{value:null,matchMode:f.EQUALS},created_at:{value:null,matchMode:f.BETWEEN}}},b=()=>{h(),o({page:l.value,rows:r.value,sortField:null,sortOrder:null,filters:a.value})};function N(e){l.value=e.page,r.value=e.rows,o({page:l.value,rows:r.value,sortField:e.sortField,sortOrder:e.sortOrder,filters:e.filters})}const _=e=>{l.value=0,r.value=e.rows,o({page:l.value,rows:r.value,sortField:e.sortField,sortOrder:e.sortOrder,filters:a.value})};function x(e,s){if(a.value[e]){if(e==="created_at"){let n=new Date(s[1]);n.setHours(23,59,59,59),s[1]=n}a.value[e].value=s}else console.error(`Filter "${e}" tidak ditemukan.`);o({page:l.value,rows:r.value,sortField:null,sortOrder:null,filters:a.value})}function C(e){a.value[e]?a.value[e].value=null:console.error(`Filter "${e}" tidak ditemukan.`),o({page:l.value,rows:r.value,sortField:null,sortOrder:null,filters:a.value})}return{columns:O,users:v,totalRecords:y,filters:a,page:l,rows:r,rowOptions:g,loading:u,loadData:o,initFilters:h,clearFilters:b,onPageChange:N,onSort:_,onFilterApply:x,onFilterClear:C,onMounted:$,formatDate:S,handleDelete:async e=>{F.require({message:"Do you want to delete this record?",header:"Danger Zone",icon:"pi pi-info-circle",rejectLabel:"Cancel",acceptLabel:"Delete",rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{var s,n,d,m;try{const t=await axios.delete(`user/delete/${e}`),M=`Delete User ${((n=(s=t==null?void 0:t.data)==null?void 0:s.user)==null?void 0:n.name)||"N/A"} successfully`;p.add({severity:"success",summary:"Success",detail:M,life:3e3}),await o({page:l.value,rows:r.value,sortField:null,sortOrder:null,filters:a.value})}catch(t){const c=((m=(d=t==null?void 0:t.response)==null?void 0:d.data)==null?void 0:m.message)||"An error occurred";p.add({severity:"error",summary:"Error",detail:`${c}`,life:3e3})}},reject:()=>{console.log("you reject")}})},menu:D}}export{T as u};
